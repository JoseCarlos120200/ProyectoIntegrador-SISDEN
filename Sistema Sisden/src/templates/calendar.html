
{% extends "layout.html" %}
{% block body %}
 <head>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.4.0/fullcalendar.css" />

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.4.0/fullcalendar.min.js"></script>
  <script>

  $(document).ready(function() {
   var calendar = $('#calendar').fullCalendar({
    defaultView: 'agendaWeek',
    slotDuration: '01:00',
    editable:true,
    header:{
     left:'prev,next today',
     center:'title',
     right:'agendaWeek'
    },
    businessHours: {
  // days of week. an array of zero-based day of week integers (0=Sunday)
      daysOfWeek: [ 1, 2, 3, 4,5 ], // Monday - Thursday

      startTime: '10:00', // a start time (10am in this example)
      endTime: '18:00', // an end time (6pm in this example)
},
    events: [{% for row in calendar %}{ id : '{{row.0}}', title : 'ocupado', start : '{{row.2}}', end : '{{row.3}}' }, {% endfor %}],
    selectable:true,
    selectHelper:true,
    select: function(start, end, allDay)
    {
     let clinica = document.getElementById("clinica").innerHTML; 
     var lugar=clinica
     var title = confirm("Â¿Estas seguro de la fecha?");
     if(title)
     {
      
      var start = $.fullCalendar.formatDate(start, "Y-MM-DD HH:mm:ss");
      var end = $.fullCalendar.formatDate(end, "Y-MM-DD HH:mm:ss");
      $.ajax({
       url:"/insert",
       type:"POST",
       data:{title:title, start:start, end:end, lugar:lugar},
       success:function(data)
       {
         //alert(data)
        alert("Perfecto, sigamos");
        window.location.replace("/insert");
       }
      })
     }
    }
 
   });
  });
    
  </script>
 </head>
 <body>
  <br />
  
  <h2 align="center"><a href="#">Citas disponibles en {{data}}</a></h2>
  <h2 align="center" id='clinica'>{{data}}</h2>
  <br />
  <div class="container">
   <div id="calendar"></div>
  </div>
    <div class="modal fade" id="myModal" role="dialog">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Modal Header</h4>
        </div>
        <div class="modal-body">
          <p>Some text in the modal.</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
      
    </div>
  </div>
 </body>
</html>
{% endblock %}